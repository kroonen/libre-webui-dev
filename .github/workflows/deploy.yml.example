name: Deploy to Production (Example)

# This is an example deployment workflow
# Copy this file and configure your secrets in GitHub repository settings

on:
  workflow_dispatch:
    inputs:
      confirm:
        description: 'Type "deploy" to confirm deployment'
        required: true
        default: ''

jobs:
  deploy:
    runs-on: ubuntu-latest
    if: ${{ github.event.inputs.confirm == 'deploy' }}
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    
    - name: Deploy to production server
      uses: appleboy/ssh-action@v1.0.0
      env:
        JWT_SECRET: ${{ secrets.JWT_SECRET }}
      with:
        host: ${{ secrets.DEPLOY_HOST }}
        username: ${{ secrets.DEPLOY_USER }}
        key: ${{ secrets.DEPLOY_SSH_KEY }}
        envs: JWT_SECRET
        script: |
          cd /opt/libre-webui
          git pull origin main
          
          # Deploy using the deployment script
          ./scripts/deploy.sh

# To use this workflow:
# 1. Go to your GitHub repository Settings > Secrets and variables > Actions
# 2. Add the following secrets:
#    - DEPLOY_HOST: Your server IP or hostname
#    - DEPLOY_USER: SSH username for your server
#    - DEPLOY_SSH_KEY: Private SSH key for server access
#    - JWT_SECRET: Secure random string for JWT tokens
# 3. Rename this file to remove .example extension
# 4. Push to your repository
# 5. Go to Actions tab and run "Deploy to Production" workflow
